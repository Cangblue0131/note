<!-- markdownlint-disable MD033 -->
<!-- markdownlint-disable MD010 -->
<!-- markdownlint-disable MD037 -->

# 更新資料

## <font size = 6> 新增資料 (INSERT) </font>

* 想在資料表中新增資料(紀錄)需使用 INSERT 敘述, 原則上, 每執行一次 INSERT 敘述可新增 1 筆資料.
* 將多個欄位名稱或內容值以逗號隔開, 並且前後已括弧圍起, 此形式稱為串列(List)
* 對資料表所有欄位執行 INSERT 的時候, 資料表名稱後方的欄位串列可以省略.
* 若想存入 NULL, 可在 VALUES 子句的內容值串列中直接寫入 「NULL」
* 資料表的欄位可以設定預設值(初始值), 設置方法為在CREATE TABLE 敘述中對欄位加上 DEFAULT 條件約束.
* 想存入預設值為內容值時, 可以採用在 INSERT 敘述的 VALUES 子句中寫入 DEFAULT 關鍵字(明示方法)、或省略欄位名稱和內容值串列(默認方法)等兩種方式.
* 從其他資料表複製資料時, 可以使用 INSERT...SELECT 敘述

```SQL
-- 建立資料表
CREATE TABLE ShohinIns(
    shohin_id			CHAR(4)			NOT NULL,
    shohin_name			VARCHAR(100)	NOT NULL,
    shohin_catalg		VARCHAR(32)		NOT NULL,
    sell_price			INTEGER			DEFAULT 0,
    buying_price		INTEGER			,
    reg_date			DATE			,
    PRIMARY KEY (shohin_id)
    );
```

## <font size = 5>INSERT 敘述</font>

```SQL
INSERT INTO <資料表名稱> (欄位名稱1,...) VALUES (內容值1,...)
```

例子 : 單行輸入資料, 並在註解寫下和其他行不同的點.

```SQL
-- 全部打出來
INSERT INTO ShohinIns (
    shohin_id, 
    shohin_name, 
    shohin_catalg,
    sell_price, 
    buying_price, 
    reg_date
)
VALUES(
    '0001', 
    'T 恤', 
    '衣物', 
    1000, 
    500, 
    '2009-09-20'
);
-- 因為是輸入全部資料, 所以可以省略欄位名稱
INSERT INTO ShohinIns
VALUES(
    '0005',
    '壓力鍋',
    '廚房用品',
    6800,
    5000,
    '2009-01-15'
);
-- INSERT 一次存入多筆資料
INSERT INTO ShohinIns
VALUES(
    '0002',
    '打孔機',
    '辦公用品',
    500,
    320,
    '2009-09-11'
),
(
    '0003',
    '襯衫',
    '衣物',
    4000,
    2800,
    NULL
),
(
    '0004',
    '菜刀',
    '廚房用品',
    3000,
    2800,
    '2009-09-20'
);
-- 存放 NULL (僅限沒有NOT NULL條件約束的欄位)
INSERT INTO ShohinIns
VALUES(
    '0006',
    '叉子',
    '廚房用品',
    500,
    NULL,
    '2009-09-20'
);
-- 存入預設值(明示方法)
INSERT INTO ShohinIns
VALUES(
    '0007',
    '刨絲器',
    '廚房用品',
    DEFAULT,
    790,
    '2008-04-28'
);
/*
-- 存入預設值(默認方法) : 直接省略該欄名和值
INSERT INTO ShohinIns (
    shohin_id, 
    shohin_name, 
    shohin_catalg,
    buying_price, 
    reg_date
)
VALUES(
    '0007',
    '刨絲器',
    '廚房用品',
    790,
    '2008-04-28'
);
*/
-- 若無預設值, 並省略則會存入 NULL
INSERT INTO ShohinIns(
    shohin_id, 
    shohin_name, 
    shohin_catalg,
    sell_price, 
    reg_date
)
VALUES(
    '0008',
    '鋼珠筆',
    '辦公用品',
    100,
    '2009-11-11'
);
```

![結果](https://imgur.com/pjMH2gQ.jpg)

---

## <font size = 5>從其他資料表篩選、複製資料</font>

```SQL
INSERT INTO <目標資料表名稱> (目標資料表欄位名稱1,...)
SELECT 複製的欄位名稱1,... -- 可放入彙總函數
FROM <複製的資料表名稱>
... --可放入其他限制條件
```

例子 : 把shohin資料表購買金額不為 NULL 的資料製作另外一個檔案

```SQL
-- 建立練習用資料表
CREATE TABLE ShohinCopy(
    shohin_id           CHAR(4)         NOT NULL,
    shohin_name         VARCHAR(100)    NOT NULL,
    shohin_catalg       VARCHAR(32)     NOT NULL,
    sell_price          INTEGER         ,
    buying_price        INTEGER         ,
    reg_date            DATE            ,
    PRIMARY KEY (shohin_id)
);
```

```SQL
-- 複製資料
INSERT INTO ShohinCopy(
    shohin_id,
    shohin_name,
    shohin_catalg,
    sell_price,
    buying_price,
    reg_date
)
SELECT
    shohin_id,
    shohin_name,
    shohin_catalg,
    sell_price,
    buying_price,
    reg_date
FROM
    shohin
WHERE
    buying_price IS NOT NULL;
```

<font size = 4 >上面的 code 可以改寫成如下 </font>

```SQL
-- 複製資料
INSERT INTO ShohinCopy
SELECT
    *
FROM
    shohin
WHERE
    buying_price IS NOT NULL;
```

![結果](https://imgur.com/MWrpg5l.jpg)

例子 : 製作一個各個商品分類後, 計算的總買賣價格的表

```SQL
--  建立表格
CREATE TABLE shohin_catalg_sum(
    shohin_catalg       VARCHAR(32)     NOT NULL,
    SUM_sell_price      INTEGER         ,
    SUM_buying_price    INTEGER         ,
    PRIMARY KEY (shohin_catalg)
);
```

```SQL
--  複製資料至表格
INSERT INTO shohin_catalg_sum
SELECT
    shohin_catalg,
    SUM(sell_price),
    SUM(buying_price)
FROM
    shohin
GROUP BY
    shohin_catalg
```

![結果](https://imgur.com/IDwiDp3.jpg)

## <font size = 6>刪除資料 (DELETE) </font>

* 將資料表完全刪除需要使用 DROP TALBE 敘述. 而想留下資料表, 只刪除資料表本身結構或紀錄時, 使用 DELETE.
* 刪除部分紀錄時, 可以使用 WHERE 子句指定刪除對象的條件. 加上 WHERE 子句限制刪除對象紀錄的 DELETE 敘述稱為 「搜尋式DELETE」.
* 因為 DELETE 是刪除資料表內的資料, 而不是欄位, 所以 DELETE 後面不能加上欄位名稱或是*

<font size = 5>DELETE 敘述的基本語法</font>

```SQL
-- 若直接這樣輸入資料表名稱, 則會清空那個資料表的資料
DELETE FROM <資料表名稱>;
```

若要清空資料表, 建議使用 TRUNCATE, 速度相對快

```SQL
TRUNCATE <資料表名稱>;
```

---

<font size = 5>搜尋式DELETE</font>

```SQL
DELETE FROM <資料表名稱>
WHERE <條件>;
```

例子 : 刪除資料表 'shohincopy' 裡面, 賣價 >= 4000 的資料

```SQL
DELETE FROM shohincopy
WHERE
    sell_price >= 4000;
```

![結果](https://imgur.com/Q0VVznl.jpg)
