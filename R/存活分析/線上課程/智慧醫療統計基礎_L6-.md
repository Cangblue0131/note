<!-- markdownlint-disable MD033 -->
<!-- markdownlint-disable MD010 -->
<!-- markdownlint-disable MD037 -->
<!-- markdownlint-disable MD041 -->

# [L6 : Mean Response, Prediction, and Residual](https://www.youtube.com/watch?v=Ue1mgEVDwq0&list=PLTp0eSi9MdkNZB4kyLSzIXIUy9JQOJ5AM&index=6)

Estimation of Mean ResonseE, 以簡單線性回歸為例.

* $E[Y|X] = \beta_0 + \beta_1X => \widehat{E[Y|X]} = \hat{\beta}_0 + \hat{\beta}_1X$
* $Var(\widehat{E[Y|X]}) = \sigma^2[\frac{1}{n} + \frac{(X-\bar{X})^2}{Sxx}]$

## Hypothesis

$H_0 : E[Y|X] = \mu_0$

$T = \frac{(\hat{\beta}_0 + \hat{\beta}_1X) - \mu_0}{\hat{\sigma}^2[\frac{1}{n} + \frac{(X-\bar{X})^2}{Sxx}]} \sim t_{n-(p+1)}$

系賴區間 : 略

## Prediction

對於估計在 $X_0$ 下的值, 使用

* $Y_0 = \beta_0 + \beta_1X_0 + \epsilon_0$

其中因 $\epsilon_0 \sim N(0, \sigma^2)$. 所以對於估計, $\epsilon_0$ 可以直接帶0. 其他的 $\beta$ 則直接帶估計值.

<font size = 3 color = red>但是對於此預測, $Y_0$ 的變異會相較於 $\hat{Y}$ 來得大.</font> 原因在於在做預測時, 必須預測兩件事情, 一是 Mean Response; 二是 . 已知 Mean Response 的 Var, 所以是加上 $\epsilon$ 的變異.

* $Var(\hat{Y}_0) = \sigma^2[1 + \frac{1}{n} + \frac{(X_0-\bar{X})^2}{Sxx}]$

也就是說, $Y_0$(估計值) 的信賴區間會比較寬.

### $Y_0$ Hypothesis

$H_0 : Y_0 = \mu_0$

$T = \frac{\hat{Y}_0 - \mu_0}{\hat{\sigma}^2[1+\frac{1}{n} + \frac{(X_0-\bar{X})^2}{Sxx}]} \sim t_{n-(p+1)}$

## Note

### Note 1

在繪製 $\hat{E}[Y|X=x]$ 的信賴區間, 在圖形上會是曲線的, 在 $X=\bar{X}$ 時區間最窄. 原因在於統計量的計算上, X越接近 $\bar{X}$ 則越窄.

預測的信賴區間就相對於 $\hat{E}[Y|X=x]$ 的信賴區間多一個 $\sigma^2$.

![L6-1](figure\L6-1.PNG)

### Note 2

資料的範圍對於模型解釋是很重要的, 建議不要對模型進行外推(推測不在範圍外的結果), 因為模型可能和真實資料差異很大.

![L6-2](figure\L6-2.PNG)

## diagnosis of regression model

目的是檢查假設是否正確, 已知現有的假設有

* $Y = E[Y|X] + \epsilon$ 中的 $\epsilon$ 和 X 獨立.
* $E[Y|X] = \beta_0 + \beta_1X$
* $\epsilon \sim N(0, \sigma^2)$

所以要做檢查的有

1. $X$ 和 $\epsilon$ 是否獨立
2. $E[Y|X]$ 和 $\epsilon$ 是否獨立
3. $i$ 和 $\epsilon$ 無關
4. $\epsilon \sim N(0, \sigma^2)$

檢查方法可以使用畫圖去推論, 以下為上面四個分別畫的圖(不要太誇張就好)

1. plot of ${(X_u, e_i)}$
2. plot of ${(\hat{\beta}_0 + \hat{\beta}_1X_i, e_i)}$
3. ${(i, e_i)}$
4. ${(e_i)}$ 繪製 QQ plot

期望上1~3的圖形如下, 必須是以0為中心上下同力度震盪, 而不是像紅色那樣有關係性(X越大震盪越大).

![L6-3](figure\L6-3.PNG)

QQ plot 類似 :

![L6-4](figure\L6-4.PNG)

## Outlier Detection : 離群值診斷

直接看數據值, 會說離平均值來得遠的值為 Outlier; 在回歸分析中, 則是以建立出來的模型具決定, 也就是該值和估計值的距離(殘差)決定.

![L6-5](figure\L6-5.PNG)

### Testing

$T_i = \frac{e_i - 0}{\sqrt{Var(e_i)}} \sim t_{(n-(p+1))}$ 當 $H_0$ 成立時.

其中, $\widehat{Var}(e_i) = \hat{e}^2[1-(\frac{1}{n} + \frac{(X_i - \bar{X})^2}{Sxx})]$

此統計量每個資料點都能夠算, 所以可以得到每個資料點的 P_value. 也就是可以檢定每個點.

# L7 : Multiple Linear Regression (1): 5 models

Response of interest : Y

Covariates : $X = (X_1, ..., X_p)$

Target : $E[Y|X]$

Model : $Y = E[Y|X] + \epsilon$

在線性回歸中, 也是假設此為線性關係. : $E[Y|X] = \beta_0 + \beta^TX$, $\epsilon \sim N(0, \sigma^2)$

所以總共需要估計的參數有 : $\theta = (\beta_0, ..., \beta_p, \sigma^2)$. 其中資料為$\{(X_{ip})\}$

<font size = 4>補 : Confouding</font>

好奇的特徵和目標在建模後雖然有關係, 但也有可能是因為其他特徵所導致的. 因此在未考慮到其他真正會影響的特徵, 可能會導致預測出現錯誤的解讀.

例如 : 預測後結論為藥物有效, 但其實因為收集資料時幾乎都收集到男性的, 且又未把性別放入特徵中, 導致無法正推論出真正原因.

## M1 : $Y = \beta_iX_i + \epsilon, i = 1 \sim2$

假設 $\beta_2$ 為性別

* $\beta_0 : 截距, 或說X都帶入0時的值(起始值)$
* $\beta_i, i \neq 0 :$ 再其他i不動的情況下, $X_i$ 每增加一單位時 Y 上升的幅度.
* 假設 $X_2$ 為離散資料(0 or 1). 則圖形就是兩個平行線, 斜率為 $\beta_1$, 兩條線的差距為 $\beta_2$.
* 若要檢定資料和性別是否無關, 則 $H_0 : \beta_2 = 0$
* 若要讓兩條線並非平行(斜率不同), 則可以加上交互作用項(interaction).

## M2 : $Y = \beta_iX_i + \beta_3(X_1X_2) + \epsilon, i = 1 \sim2$

interaction(交互作用) : 變數之間有關係(不獨立), 導致不同類別變相帶入後, 模型間不平行.

* 若要檢定資料和性別是否無關, 則 $H_0 : \beta_2 = \beta_3 = 0$
* 假設不知道模型用哪個, 又要檢定性別是否有影響, 可以使用比較複雜的模型進行. 不過用比較複雜的模型, 會使得估計的效度較低. 因再相同的資料量下, 要估計的變數較多, 所以越複雜的模型, 估計的變異會越大.
* 若要檢定成長速率是否和性別有關, 則是檢定 $H_0 : \beta_3 = 0$
