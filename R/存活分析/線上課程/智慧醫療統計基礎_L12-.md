<!-- markdownlint-disable MD033 -->
<!-- markdownlint-disable MD010 -->
<!-- markdownlint-disable MD037 -->
<!-- markdownlint-disable MD041 -->
<!-- markdownlint-disable MD024 -->

# L12 Generalized Linear Model

從此開始 Y 可能是離散型資料, 例如 Y = {0,1} 或 count data : {0, 1, 2, ...}

過去目標是得到 $Y = E[Y|X] + \epsilon$, 其中 $E[Y|X] = \beta_0 + \beta^TX$, $Y \sim N(E[Y|X], \sigma^2)$. 不過若 Y 為離散型, 則此結果會很奇怪.

當 Y 為 {0, 1} 時, $E[Y|X] = P(Y=1|X) \in [0, 1]$; 當 Y 為 {0, 1, ....}時, $E[Y|X]$ 也 $\in [0, 1]$

## 此時會用到的分佈

### Bernoulli

$Y~\sim Ber(p)$ with $p = P(Y=1)$.

* $f(y) = p^y(1-p)^{(1-y)},~ y = 0, 1$
* $E(Y) = p$
* $Var(Y) = p(1-p)$, 所以 p = 0.5 時變異最大.

### Poission

$Y \sim Poi(\lambda)$

* $f(y) = \frac{e^{-\lambda}\lambda^y}{y!}$
* $E(Y) = \lambda$
* $Var(Y) = \lambda$

## Estimation of parameter

由 $Y_i \sim(iid) Ber(p)$ 來說

### likehood function

從假設給定 p, 求得 "看到目前資料的機率去推論" 最有可能的p.

看到目前資料的機率 $Y_i \to f_p(Y_i)$, 所以看到整組資料的機率為 $\prod f_p(Y_i) = L(p)$.

其值可畫出圖形類似如下:

![L12-1](figure\L12-1.PNG)

最高點代表是 該p的情況下 此資料最有可能出現, 找這點的估計方法稱為 MLE(最大概似估計, maximum likelihood estimation).

從式子可知道, $L(p) = \prod(p^{Y_i}(1-p)^{(1-Y_i)})$. 使用 log 和 微分最後推得出 $\hat{p} = \frac{1}{n}\sum Y_i$

## Inference rocedure

Model : $Y \sim f_\theta(y)$

Data : ${Y_i}$

Aim : estimate $\theta$ $\to$ 使用 MLE 估計.
